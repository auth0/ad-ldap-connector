<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <Fragment>
    <CustomAction
      Id='RegisterAdminService'
      Impersonate="no"  
      Execute="deferred" 
      FileKey='nssm'
      ExeCommand='install "Auth0 ADLDAP Admin" "[INSTALLDIR]\node.exe" "\"[INSTALLDIR]\admin\server.js\""'
      Return='asyncWait' />

    <CustomAction
      Id='RegisterConnectorService'
      Impersonate="no"  
      Execute="deferred" 
      FileKey='nssm'
      ExeCommand='install "Auth0 ADLDAP" powershell ./start-connector.ps1'
      Return='asyncWait' />

    <CustomAction
      Id='SetupConnectorServicePath'
      Impersonate="no"
      Execute="deferred"
      FileKey='nssm'
      ExeCommand='set "Auth0 ADLDAP" AppDirectory "[INSTALLDIR]"'
      Return='asyncWait' />

  </Fragment>
</Wix>
